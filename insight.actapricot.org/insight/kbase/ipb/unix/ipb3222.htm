<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

<style type="text/css"><!--
	body { font-family: Arial, Helvetica, sans-serif; }

//-->
</style>
<meta name="generator" content="Microsoft FrontPage 3.0">
<title>Xenix - Unix I.P.B. 3222</title>
</head>

<body background="../../../images/mits-bg5.gif" bgcolor="#ffffff" link="#d60029"
alink="#d60029" vlink="#800080" leftmargin="0" marginwidth="0" marginheight="6">
<!-- Header - start of top table -->
<table border="0" cellpadding="0" cellspacing="0" width="98%">
<!-- The top table has the Mitsubishi logo and Home button -->
  <tr>
    <td valign="top"><img src="../../../images/m-logo-s.gif" width="193" height="70" alt="Mitsubishi Electric - Computing for a Connected World"></td>
        <td valign="bottom" align="right"><a href="../../../default.htm"><img width="41" height="32" src="../../../images/bt-home.gif" alt="Insight CD Home Page" border="0"></a></td>
  </tr>
  <tr>
    <td width="98%" colspan="2" bgcolor="#000000"><img width="1" height="1" src="../../../images/space.gif"><br>
    </td>
  </tr>
</table>
<!-- end of top table -->


<table border="0" cellpadding="0" cellspacing="0" width="98%">
  <tr>
    <td width="10" bgcolor="#000000"><img width="10" height="10"
    src="../../../images/space.gif"></td>
    <td width="120" valign="top" align="left" bgcolor="#000000"><script LANGUAGE="JavaScript">

<!--

        if (document.images) {

          var product1 = new Image()
          product1.src = "/insight/images/product1.gif"
          var product2 = new Image()
          product2.src = "/insight/images/product2.gif"

          var service1 = new Image()
          service1.src = "/insight/images/service1.gif"
          var service2 = new Image()
          service2.src = "/insight/images/service2.gif"

          var kbase1 = new Image()
          kbase1.src = "/insight/images/kbase1.gif"
          var kbase2 = new Image()
          kbase2.src = "/insight/images/kbase2.gif"       

          var upgrade1 = new Image()
          upgrade1.src = "/insight/images/upgrade1.gif"
          var upgrade2 = new Image()
          upgrade2.src = "/insight/images/upgrade2.gif"       

          var downlo1 = new Image()
          downlo1.src = "/insight/images/downlo1.gif"
          var downlo2 = new Image()
          downlo2.src = "/insight/images/downlo2.gif"       

          var inserv1 = new Image()
          inserv1.src = "/insight/images/inserv1.gif"
          var inserv2 = new Image()
          inserv2.src = "/insight/images/inserv2.gif"       

          var email1 = new Image()
          email1.src = "/insight/images/email1.gif"
          var email2 = new Image()
          email2.src = "/insight/images/email2.gif"       

          var search1 = new Image()
          search1.src = "/insight/images/search1.gif"
          var search2 = new Image()
          search2.src = "/insight/images/search2.gif"       

          var y20001 = new Image()
          y20001.src = "/insight/images/y2001.gif"
          var y20002 = new Image()
          y20002.src = "/insight/images/y2002.gif"

          var osites1 = new Image()
          osites1.src = "/insight/images/osites1.gif"
          var osites2 = new Image()
          osites2.src = "/insight/images/osites2.gif"

          var disclaim1 = new Image()
          disclaim1.src = "/insight/images/disclam1.gif"
          var disclaim2 = new Image()
          disclaim2.src = "/insight/images/disclam2.gif"

        }



        function act(imgName) {
          if (document.images)
            document[imgName].src = eval(imgName + '2.src')
        }



        function inact(imgName) {
          if (document.images)
            document[imgName].src = eval(imgName + '1.src')
        }

        // -->
</script>


    <a HREF="../../../products/main.htm" onMouseOver="act('product')" onMouseOut="inact('product')"><img width="113" height="22" src="../../../images/product1.gif" name="product" alt="Products" border="0"></a><br>

    <a HREF="../../../services/main.htm" onMouseOver="act('service')" onMouseOut="inact('service')"><img width="113" height="22" src="../../../images/service1.gif" name="service" alt="Services" border="0"></a><br>

    <a HREF="../../main.htm"><img width="113" height="22" src="../../../images/kbase2.gif" name="kbase" alt="Knowledgebase" border="0"></a><br>
       <a HREF="../ipbmain.htm"><img width="113" height="17" src="../../../images/s_ipb.gif" alt="Bulletins (IPBs)" border="0"></a><br>
       <a HREF="../../guides/guidecon.htm"><img width="113" height="17" src="../../../images/s_guides.gif" alt="Guides" border="0"></a><br>
       <a HREF="../../faq/main.htm"><img width="113" height="17" src="../../../images/s_faq.gif" alt="FAQs" border="0"></a><br>
       <a HREF="../../guides/manuals/menu.htm"><img width="113" height="17" src="../../../images/s_manual.gif" alt="Owner's Handbooks" border="0"></a><br>
       <a HREF="../../../common/infact/menu.htm"><img width="113" height="17" src="../../../images/s_datash.gif" alt="Product Datasheets" border="0"></a><br>
       <a HREF="../../../common/misc/menu.htm"><img width="113" height="17" src="../../../images/s_misc.gif" alt="Miscellaneous Items" border="0"></a><br>

    <a HREF="../../../upgrades/main.htm" onMouseOver="act('upgrade')" onMouseOut="inact('upgrade')"><img width="113" height="22" src="../../../images/upgrade1.gif" name="upgrade" alt="Upgrades" border="0"></a><br>

    <a HREF="../../../download/main.htm" onMouseOver="act('downlo')" onMouseOut="inact('downlo')"><img width="113" height="22" src="../../../images/downlo1.gif" name="downlo" alt="Downloads" border="0"></a><br>

    <a HREF="../../../insindex.exe" onMouseOver="act('search')" onMouseOut="inact('search')"><img width="113" height="22" src="../../../images/search1.gif" name="search" alt="Search Insight" border="0"></a><br>
    <a HREF="mailto:insight@mitsubishi-computers.com" onMouseOver="act('email')" onMouseOut="inact('email')"><img width="113" height="22" src="../../../images/email1.gif" name="email" alt="E-Mail us" border="0"></a><br>
    <a HREF="http://www.mitsubishi-computers.com/support/service/" onMouseOver="act('inserv')" onMouseOut="inact('inserv')"><img width="113" height="22" src="../../../images/inserv1.gif" name="inserv" alt="Insight Service" border="0"></a><br>

    <a HREF="../../../common/year2000/year2000.htm" onMouseOver="act('y2000')" onMouseOut="inact('y2000')"><img width="113" height="21" src="../../../images/y2001.gif" name="y2000" alt="Year 2000" border="0"></a><br>
    <a HREF="../../../common/oth-site/oth-site.htm" onMouseOver="act('osites')" onMouseOut="inact('osites')"><img width="113" height="38" src="../../../images/osites1.gif" name="osites" alt="Other Mitsubishi Sites" border="0"></a><br>
    <a HREF="../../../common/disclaim.htm" onMouseOver="act('disclaim')" onMouseOut="inact('disclaim')"><img width="113" height="24" src="../../../images/disclam1.gif" name="disclaim" alt="Site Disclaimer" border="0"></a><br>
      
    <img width="113" height="120" src="../../../images/space.gif"><br>
</td>
    <td width="10" valign="top" width="10" height="10" src="/insight/images/space.gif"
    alt="10 pixel Gap" border="0"></td>
    <td valign="top">&nbsp;<table border="0" width="100%" bgcolor="#FFFFC0">
      <tr>
        <td colspan="2"><font face="Arial,Helvetica" size="4" color="#D60029"><strong>Xenix - Unix
        I.P.B. 3222 </strong></font></td>
        <td valign="bottom"><strong><font size="2">6th July 1998 (JE) </font></strong></td>
      </tr>
      <tr>
        <td><strong><font size="2">Department </font></strong></td>
        <td><strong><font size="2">Category </font></strong></td>
        <td><strong><font size="2">Implementation </font></strong></td>
      </tr>
      <tr>
        <td colspan="3" bgcolor="#000000" height="1"></td>
      </tr>
      <tr>
        <td><font size="2">Unix </font></td>
        <td><font size="2">Software </font></td>
        <td><font size="2">Advisory </font></td>
      </tr>
    </table>
    <table border="0" width="100%">
      <tr>
        <td align="center" width="50%"><a href="ipb3221.htm"><font size="2">Previous IPB</font></a></td>
        <td align="center" width="50%"><a href="ipb3223.htm"><font size="2">Next IPB</font></a></td>
      </tr>
    </table>
    <table border="0" width="100%">
      <tr>
        <td><font><b><u><p ALIGN="CENTER"></u><font size="3"><strong>Configuration of additional
        SCSI disks under OpenServer 5.0.4</strong></font></b></font><u></p>
        <p><font size="2">Additional disks at install time</font></u></p>
        <p><font size="2">Problems will occur if installing OpenServer 5.0.4 on a system with more
        than one SCSI disk fitted and the auto-detection feature of the installation is used to
        add support for the drive. When considering a two drive system the second drive will be
        installed into the kernel, but fdisk and divvy will actually be manipulating the first
        (root) disk when accessing the second disk. This can be proved by running </font><font
        face="Courier" size="2">fdisk -f /dev/hd10</font><font><font size="2"> or</font> </font><font
        face="Courier" size="2">divvy /dev/hd1a</font><font> <font size="2">&#150; in both cases
        the disk being viewed will be the root disk. To avoid this problem add </font></font><font
        face="Courier" size="2">scsi.noscan</font><font><font size="2"> to the bootstring when
        installing. An example bootstring for the FT1200 Pentium II would be:</font></p>
        <blockquote>
          <blockquote>
            </font><font FACE="Courier" size="1"><p></font><font face="Courier" size="2">defbootstr
            ahslink=alad325 Stp=alad(1,0,2,0) scsi.noscan</font><font FACE="Courier" size="1"></p>
            </font><font><p><font size="2">Refer to <a href="ipb3220.htm">IPB 3220</a> for FT1200
            Pentium II installation instructions.</font></font></p>
          </blockquote>
        </blockquote>
        <p><font><font size="2">If however the installation has been carried out and the problem
        exists then the following procedure can be used to remove the incorrectly defined second
        disk from the system, and then add the disk correctly using</font> </font><font
        face="Courier" size="2">mkdev&nbsp;hd</font><font size="2">. This procedure assumes that
        there is one extra drive configured that needs removing, additional drives are defined in
        a similar fashion starting as number two:</font><ol>
          <font size="2">
          <li><font><font size="2">Remove the device nodes </font><font face="Courier" size="2">/dev/hd1*
            <font>,</font> /dev/rhd1* <font>,</font> /dev/dsk/1s* <font>,</font> /dev/rdsk/1s*</font><font
            FACE="Courier"><br>
            <br>
          </li>
          </font><font>
          <li><font size="2">Remove the file </font></font><font face="Courier" size="2">/etc/conf/node.d/Sdsk</font><font
            FACE="Courier"><br>
            <br>
          </li>
          </font><font>
          <li><font size="2">Edit the file /etc/conf/cf.d/mscsi removing all lines containing Sdsk
            except the line referring to the first disk. For example the following line is such a line
            that should remain for an Adaptec 78xx based system:</font></li>
          </font><font FACE="Courier"><p></font><font face="Courier" size="2">alad Sdsk 0 0 0 0</font><font
          FACE="Courier"></p>
          </font><font>
          <li><font size="2">Edit the file </font></font><font face="Courier" size="2">/var/opt/K/SCO/link/1.1.0Eb/usr/lib/mkdev/perms/HDLIST</font><font><font
            size="2"> removing additional disk definitions so that it has only one line as below:</font></li>
          </font><font FACE="Courier"><p></font><font face="Courier" size="2">0 /etc/conf/node.d/hd
          0</font><font FACE="Courier"></p>
          </font><font>
          <li><font size="2">Change directory to </font></font><font face="Courier" size="2">/etc/conf/pack.d/Sdsk</font></font><font
            size="2"> and check the contents of the two files device.dat and space.c. They should not
            need editing, but if they do the entries to remove are shown below in a </font><font
            face="Courier" size="2"><font><b>bold font</b></font>:</font></li>
        </ol>
        <ol start="6">
          <font size="2"><p><font size="2">File: device.dat</font></font></p>
          <p><font face="Courier" size="2">FILE_FORMAT:</font></p>
          <blockquote>
            <p><font face="Courier" size="2">version=1</font></p>
          </blockquote>
          <p><font face="Courier" size="2">Sdsk0:</font></p>
          <blockquote>
            <p><font face="Courier" size="2">INDEX=Sdsk0<br>
            PATH=node0,node1<br>
            node0=D_SUBSYS,SCSI Disk,0,D_HARDDSK_SUBSYS,,NULL<br>
            node1=D_UNIT,SCSI Drive 0,0,0,D_RANDOM_ACCESS D_NODE,NULL<br>
            D_USER_MSG=SCSI Disk Drive,0,0,,NULL<br>
            D_BLOCK_NODE = 0<br>
            D_CHAR_NODE = 0</font></p>
          </blockquote>
          <b><p><font face="Courier" size="2">Sdsk1:</font></p>
          <blockquote>
            <p><font><font face="Courier" size="2">INDEX=Sdsk1<br>
            PATH=node0,node1<br>
            node0=D_SUBSYS,SCSI Disk,0,D_HARDDSK_SUBSYS,,NULL<br>
            node1=D_UNIT,SCSI Drive 1,0,1,D_RANDOM_ACCESS D_NODE,NULL<br>
            D_USER_MSG=SCSI Disk Drive,0,0,,NULL<br>
            D_BLOCK_NODE = 64<br>
            D_CHAR_NODE = 64</font><font FACE="Courier" size="1"></p>
          </blockquote>
          </font></b><p><font size="2">File: space.c &#150; the end of the file</font></font></p>
          <p><font face="Courier" size="2">.<br>
          .<br>
          .<br>
          /*<br>
          Probe routine return values, the marker comments must be kept in place<br>
          so that the mkdev script can patch up this file correctly<br>
          */<br>
          /*_PROBE_START_*/<br>
          #define Sdsk0 99328 /* Sdsk0 */<br>
          <b>#define Sdsk1 99329 /* Sdsk1 */<br>
          </b>int SdskProbe[] = {Sdsk0<b>,Sdsk1</b>,0};<br>
          /*_PROBE_STOP_*/</font></p>
          <p><font face="Courier" size="2">/* End probe routine return values */</font></p>
          <li><font><font size="2">Edit the file </font><font face="Courier" size="2">/etc/default/filesys</font><font
            size="2"> and check for any entries after the one for the </font><font face="Courier"
            size="2">root</font><font size="2"> and</font> <font face="Courier" size="2">rroot</font><font
            size="2">. There will probably be an entry for a filesystem called &quot;a&quot;, the
            entry referring to</font> <font face="Courier" size="2">/dev/a</font> <font size="2">and</font>
            <font face="Courier" size="2">/dev/ra</font><font size="2">. Remove any such device nodes
            (</font><font face="Courier" size="2">rm /dev/a /dev/ra</font><font size="2">), the
            mountpoint directory (</font><font face="Courier" size="2">rmdir&nbsp;/a</font><font
            size="2">), and the entry in the filesys file. The entry to remove is shown below in a</font>
            <font face="Courier" size="2"><b>bold font</b></font>:<br>
            <br>
            </font></li>
          <p><font face="Courier" size="2">bdev=/dev/boot cdev=/dev/rboot \</font></p>
          <blockquote>
            <p><font face="Courier" size="2">mountdir=/stand mount=no fstyp=EAFS \<br>
            fsck=no fsckflags= rcmount=yes \<br>
            rcfsck=no mountflags= </font></p>
          </blockquote>
          <p><font face="Courier" size="2">bdev=/dev/root cdev=/dev/rroot \</font></p>
          <blockquote>
            <p><font face="Courier" size="2">mountdir=/ mount=no fstyp=HTFS \<br>
            fsck=no fsckflags= rcmount=no \<br>
            rcfsck=no mountflags= </font></p>
          </blockquote>
          <b><p><font face="Courier" size="2">bdev=/dev/a cdev=/dev/ra \</font></p>
          <blockquote>
            <p><font><font face="Courier" size="2">mountdir=/a mount=no fstyp=HTFS \<br>
            fsck=no fsckflags= rcmount=no \<br>
            rcfsck=no mountflags= </font><font FACE="Courier" size="1"></p>
          </blockquote>
          </font></b>
          <li><font size="2">Re-link the kernel by running /etc/conf/cf.d/link_unix and answer yes to
            the question asking if the environment is to be rebuilt which re-creates the device nodes
            under the /dev directory. Reboot the system and check that there are only device nodes for
            the first disk under /dev, these being /dev/hd0* , /dev/rhd0* , /dev/dsk/0s* , and
            /dev/rdsk/0s*.</font><br>
            <br>
          </li>
          <li><font size="2">At this stage the system should be running with only the first (root)
            disk configured. To successfully add the second and any other disks use the </font><font
            face="Courier" size="2">mkdev&nbsp;hd</font><font size="2"> command. As an example, for an
            FT1200 with a second disk set to SCSI ID 1 connected to the first on-board Adaptec channel
            the following answers are used (answers shown in </font><font face="Courier" size="2">this
            font</font><font size="2">):</font><br>
          </li>
          <p><font size="2">Pick one of the choices&#133;..<br>
          Enter 1, 2, or 3&#133;..(add disk to SCSI controller) 2 </font></p>
          <p><font size="2">Enter the prefix of the SCSI host adapter&#133;&#133;<br>
          or press &lt;Return&gt; for the default: &#145;alad&#146; </font><font face="Courier"
          size="2">&lt;CR&gt;</font><font size="2"> or </font><font face="Courier" size="2">alad</font></p>
          <p><font size="2">Which &#145;alad&#146; SCSI host adapter&#133;.. </font><font
          face="Courier" size="2">0</font></font></p>
          <p><font size="2">What SCSI Bus &#133;&#133;.. </font><font face="Courier" size="2">0</font></p>
          <p><font size="2">What is the Target ID&#133;. </font><font face="Courier" size="2">1</font></p>
          <p><font size="2">What is the LUN&#133;&#133; </font><font face="Courier" size="2">0</font></p>
          <p><font size="2">Allow the kernel to be re-linked, made the boot kernel, and the
          environment rebuilt. Shut the system down and re-boot.</font></p>
          <li><font><font size="2">Run the </font><font face="Courier" size="2">mkdev hd</font><font
            size="2"> command again, selecting the same options as above. This time though it will
            invoke fdisk followed by divvy. Select the option to use the entire disk for unix under
            fdisk. The divvy utility will ask how many filesystems are required and equally divide
            available blocks, however if further control is required over the filesystem sizes this
            can also be done at this time or by running </font><font face="Courier" size="2">divvy&nbsp;/dev/hd1a</font><font
            size="2"> at a later time.</font><br>
            <br>
          </li>
          <li><font size="2">The filesystem(s) will now exist on the second disk but will not be
            automatically mounted during multi-user boot and will not contain a lost+found directory
            with &quot;empty slots&quot;. To configure, run the command </font><font face="Courier"
            size="2">mkdev&nbsp;fs</font><font size="2"> and give the device names of the filesystems,
            for example /dev/u, and the mount point, for example /u. You are then asked whether the
            filesystem is always to be mounted and whether users can mount it &#150; answer no to this
            second question.</font></font></li>
          </font>
        </ol>
        <u><p><font size="2">Removal of additional disks when added after installation</font></u></p>
        <p><font size="2">When a drive is added to an installed OpenServer 5.0.4 system with the </font><font
        face="Courier" size="2">mkdev hd</font><font><font size="2"> command the files that define
        its configuration are slightly different to those in the above numbered procedure. There
        will not be an Sdsk file in the /etc/conf/node.d directory. The additional drive(s) are
        defined in the hd file. For a second disk there will be several lines distributed
        throughout the /etc/conf/node.d/hd file that define the device nodes. The order of these
        are as follows and to manually remove such a drive they need to be deleted:</font></p>
        <blockquote>
          <font FACE="Courier"><p></font><font face="Courier" size="2">dsk/1s* 15 lines<br>
          hd1* 7 lines<br>
          rdsk/1s* 15 lines<br>
          rhs1* 7 lines</font></p>
        </blockquote>
        <p><font size="2">The file </font></font><font face="Courier" size="2">/var/opt/K/SCO/link/1.1.0Eb/usr/lib/mkdev/perms/HDLIST</font><font
        size="2"> will not require modification. There will only be one line of the form shown in
        4. above.</font><font></p>
        <p><font size="2">The </font></font><font face="Courier" size="2">/etc/conf/cf.d/mscsi</font><font
        size="2"> file will have the same additional lines per disk as in 3. above that require
        removal.</font></p>
        <p><font size="2">The </font><font face="Courier" size="2">device.dat</font><font size="2">
        and </font><font face="Courier" size="2">space.c</font><font size="2"> files in </font><font
        face="Courier" size="2">/etc/conf/pack.d/Sdsk</font><font size="2"> will have the
        additional entries as in 5. above, and they will require removal.</font></p>
        <p align="center"><font size="2">----------oOo---------- </font></p>
        <p align="center"><font size="2">&nbsp;&nbsp;</font></td>
      </tr>
    </table>
    <p align="center"><img width="486" height="25" src="../../../images/connectd.gif"
    alt="Computing for a Connected World"> </td>
  </tr>
</table>
</body>
</html>
